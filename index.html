<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>VRealms</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="css/style.css" />

  <!-- PATCH UI DIRECT DANS INDEX (cartouches + webp + tooltip i18n) -->
  <style>
    /* ===== Icônes WebP en haut : pas d’effet autour, juste l’image ===== */
    .vr-header{
      position: fixed !important;
      top: 0 !important; left: 0 !important; right: 0 !important;
      z-index: 9999 !important;
      padding: 10px 12px !important;
      background: transparent !important;
    }
    .vr-top-actions{
      display: flex !important;
      justify-content: center !important;
      gap: 10px !important;
    }
    .vr-icon-button{
      width: 44px !important;
      height: 44px !important;
      border: 0 !important;
      background: transparent !important;
      box-shadow: none !important;
      backdrop-filter: none !important;
      -webkit-backdrop-filter: none !important;
      padding: 0 !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      cursor: pointer !important;
    }
    .vr-icon-button img{
      width: 30px !important;
      height: 30px !important;
      object-fit: contain !important;
      display: block !important;
      filter: none !important;
      pointer-events: none !important;
      user-select: none !important;
    }

    /* Laisse de la place sous le header */
    .vr-main{ padding-top: 72px !important; }

    /* ✅ Logo un peu plus bas (entre icônes et titre) */
    .vr-intro{
      margin-top: 14px !important;
      margin-bottom: 12px !important;
      display: flex !important;
      justify-content: center !important;
    }
    .vr-main-logo{
      margin-top: 6px !important;
    }

    /* ===== Cartouches : plus grandes + fond webp 50% + texte au-dessus ===== */
    .vr-universe-grid{
      display: grid !important;
      grid-template-columns: 1fr !important;
      gap: 14px !important;
    }

    .vr-card{
      position: relative !important;
      overflow: hidden !important;
      width: 100% !important;
      min-height: 64px !important;
      height: 64px !important;
      border-radius: 18px !important;
      cursor: pointer !important;
      border: 0 !important;
      outline: 0 !important;
    }

    /* Fond webp */
    .vr-card-bg{
      position: absolute !important;
      inset: 0 !important;
      background-size: cover !important;
      background-position: center !important;
      opacity: .5 !important; /* ✅ 50% */
      z-index: 0 !important;
    }

    /* voile pour lisibilité */
    .vr-card::after{
      content: "" !important;
      position: absolute !important;
      inset: 0 !important;
      background: linear-gradient(180deg, rgba(0,0,0,.10), rgba(0,0,0,.62)) !important;
      pointer-events: none !important;
      z-index: 1 !important;
    }

    .vr-card-content{
      position: relative !important;
      z-index: 2 !important;
      height: 100% !important;
      display: flex !important;
      align-items: center !important;
    }

    .vr-card-header-line{
      width: 100% !important;
      display: flex !important;
      align-items: center !important;
      justify-content: space-between !important;
      gap: 12px !important;
      padding: 0 14px !important;
    }

    .vr-card-title{
      margin: 0 !important;
      color: #fff !important;
      font-weight: 900 !important;
      font-size: 16px !important;
      letter-spacing: .2px !important;
      line-height: 1.1 !important;
      text-shadow: 0 2px 10px rgba(0,0,0,.85) !important;
    }

    /* ✅ ? DANS la cartouche : quasi transparent (plus de rond blanc) */
    .vr-info-btn{
      width: 40px !important;
      height: 40px !important;
      border-radius: 999px !important;
      background: rgba(255,255,255,.10) !important;
      border: 1px solid rgba(255,255,255,.18) !important;
      color: rgba(255,255,255,.95) !important;
      font-weight: 900 !important;
      font-size: 16px !important;
      display: inline-flex !important;
      align-items: center !important;
      justify-content: center !important;
      box-shadow: none !important;
      user-select: none !important;
      flex: 0 0 auto !important;
      cursor: pointer !important;
    }
    .vr-info-btn:hover{ background: rgba(255,255,255,.14) !important; }
    .vr-info-btn:active{ transform: scale(.96) !important; }

    /* ✅ Enlève l'effet "bandeau" de la carte disabled */
    .vr-card.vr-card-disabled,
    .vr-card[disabled]{
      opacity: .55 !important;
      border: 0 !important;
      outline: 0 !important;
      box-shadow: none !important;
      filter: none !important;
    }
    /* ⚠️ On ne coupe pas ::after sinon on perd le voile sur toutes les cartes.
       On coupe juste l'ombre / effets potentiels. */
    .vr-card.vr-card-disabled::before{
      box-shadow: none !important;
    }

    /* Mobile */
    @media (max-width: 520px){
      .vr-main{ padding-top: 64px !important; }
      .vr-card{ min-height: 60px !important; height: 60px !important; }
      .vr-card-title{ font-size: 14px !important; }
      .vr-info-btn{ width: 38px !important; height: 38px !important; font-size: 15px !important; }
      .vr-icon-button{ width: 40px !important; height: 40px !important; }
      .vr-icon-button img{ width: 28px !important; height: 28px !important; }
    }
  </style>
</head>

<body class="vr-body">
  <div class="vr-overlay"></div>

  <header class="vr-header">
    <div class="vr-top-actions">
      <button class="vr-icon-button" data-view-target="profile" aria-label="Profil">
        <img src="assets/img/ui/btn_profile.webp" alt="" draggable="false" />
      </button>
      <button class="vr-icon-button" data-view-target="settings" aria-label="Paramètres">
        <img src="assets/img/ui/btn_settings.webp" alt="" draggable="false" />
      </button>
      <button class="vr-icon-button" data-view-target="shop" aria-label="Boutique">
        <img src="assets/img/ui/btn_shop.webp" alt="" draggable="false" />
      </button>
    </div>
  </header>

  <main class="vr-main">
    <!-- Vue : Accueil / choix d'univers -->
    <section id="view-home" class="vr-view vr-view-active">
      <section class="vr-intro">
        <img
          src="assets/img/ui/logo_vrealms.webp"
          alt="VRealms"
          class="vr-main-logo"
          draggable="false"
        />
      </section>

      <section class="vr-universes">
        <h2 class="vr-section-title" data-i18n="ui.choose_universe"></h2>

        <div class="vr-universe-grid">
          <!-- Roi des Enfers -->
          <button class="vr-card" data-universe="hell_king" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/hell_king.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.hell_king.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.hell_king.desc"
                  data-tip="Dirige les légions démoniaques, gère l’afflux d’âmes damnées et maintiens l’équilibre entre chaos et ordre cosmique."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Paradis -->
          <button class="vr-card" data-universe="heaven_king" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/heaven_king.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.heaven_king.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.heaven_king.desc"
                  data-tip="Arbitre les prières, contiens le fanatisme et décide jusqu’où le Ciel doit intervenir dans le monde des mortels."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Roi médiéval -->
          <button class="vr-card" data-universe="medieval_king" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/medieval_king.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.medieval_king.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.medieval_king.desc"
                  data-tip="Église, armée, peuple, trésor : chaque décision rapproche ton royaume de la prospérité… ou de la révolte."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Président puissance occidentale -->
          <button class="vr-card" data-universe="western_president" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/western_president.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.western_president.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.western_president.desc"
                  data-tip="Opinion publique, économie, diplomatie et crises médiatiques. Une signature peut tout faire basculer."
                >?</span>
              </div>
            </div>
          </button>

          <!-- CEO méga-entreprise -->
          <button class="vr-card" data-universe="mega_corp_ceo" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/mega_corp_ceo.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.mega_corp_ceo.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.mega_corp_ceo.desc"
                  data-tip="Investisseurs, employés, régulateurs et image de marque. Pousse la valorisation au sommet sans tout faire exploser."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Explorateur du Nouveau Monde -->
          <button class="vr-card" data-universe="new_world_explorer" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/new_world_explorer.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.new_world_explorer.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.new_world_explorer.desc"
                  data-tip="Conquiers, convertis et négocie avec les royaumes locaux tout en rendant des comptes à ta couronne."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Seigneur vampire -->
          <button class="vr-card" data-universe="vampire_lord" type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/vampire_lord.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.vampire_lord.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="0"
                  data-i18n-tip="universe.vampire_lord.desc"
                  data-tip="Étends ton influence dans l’ombre. Trop de sang attire les chasseurs, trop de prudence affaiblit ton clan."
                >?</span>
              </div>
            </div>
          </button>

          <!-- Univers futur verrouillé -->
          <button class="vr-card vr-card-disabled" disabled type="button">
            <div class="vr-card-bg" style="background-image:url('assets/img/ui/universes/locked.webp');"></div>
            <div class="vr-card-content">
              <div class="vr-card-header-line">
                <h3 class="vr-card-title" data-i18n="universe.locked.title"></h3>
                <span
                  class="vr-info-btn"
                  role="button"
                  tabindex="-1"
                  aria-hidden="true"
                  data-i18n-tip="universe.locked.desc"
                >?</span>
              </div>
            </div>
          </button>

        </div>
      </section>
    </section>

    <!-- (Tes autres vues peuvent rester inchangées si tu les utilises ailleurs) -->
    <section id="view-game" class="vr-view"></section>
    <section id="view-profile" class="vr-view"></section>
    <section id="view-shop" class="vr-view"></section>
    <section id="view-settings" class="vr-view"></section>
  </main>

  <footer class="vr-footer">
    <span class="vr-footer-text" data-i18n="ui.footer"></span>
  </footer>

  <div id="vr-tooltip" class="vr-tooltip"></div>

  <script>
    // Helpers i18n : supporte VRI18n.t (nouveau) + i18nGet (ancien)
    function _t(key) {
      try {
        if (window.VRI18n && typeof window.VRI18n.t === "function") return window.VRI18n.t(key) || "";
        if (typeof window.i18nGet === "function") return window.i18nGet(key) || "";
      } catch (_) {}
      return "";
    }

    // 1) Tooltip sur "?"
    (function () {
      const tooltip = document.getElementById("vr-tooltip");
      if (!tooltip) return;

      function hideTooltip() {
        tooltip.classList.remove("vr-tooltip-visible");
        tooltip.style.display = "none";
      }

      function showTooltip(el) {
        let text = el.getAttribute("data-tip") || "";
        const key = el.getAttribute("data-i18n-tip");
        const tr = key ? _t(key) : "";
        if (tr) text = tr;

        const rect = el.getBoundingClientRect();
        const scrollY = window.scrollY || window.pageYOffset;
        const scrollX = window.scrollX || window.pageXOffset;

        tooltip.textContent = text || "?";
        tooltip.style.display = "block";
        tooltip.style.top = rect.bottom + 8 + scrollY + "px";
        tooltip.style.left = rect.left + rect.width / 2 + scrollX + "px";
        tooltip.classList.add("vr-tooltip-visible");
      }

      document.querySelectorAll(".vr-info-btn").forEach((el) => {
        el.addEventListener("click", function (e) {
          e.preventDefault();
          e.stopPropagation(); // ✅ ne lance pas la cartouche
          showTooltip(el);
        });

        el.addEventListener("keydown", function (e) {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            e.stopPropagation();
            showTooltip(el);
          }
        });
      });

      document.addEventListener("click", hideTooltip);
      window.addEventListener("scroll", hideTooltip, { passive: true });
      window.addEventListener("resize", hideTooltip);
    })();

    // 2) Cliquer sur une cartouche => set univers + go game.html
    (function () {
      function launchUniverse(universeId) {
        if (!universeId) return;
        localStorage.setItem("vrealms_universe", universeId);
        window.location.href = "game.html";
      }

      document.querySelectorAll(".vr-card[data-universe]").forEach((card) => {
        card.addEventListener("click", (e) => {
          // si clic sur ?, c’est stoppé plus haut
          const id = card.getAttribute("data-universe");
          launchUniverse(id);
        });
      });
    })();
  </script>

  <script src="js/userData.js"></script>
  <script src="js/ads.js"></script>
  <script src="js/purchases.js"></script>
  <script src="js/shop.js"></script>
  <script src="js/i18n.js"></script>
  <script src="js/game.js"></script>
</body>
</html>
